<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valit - Dashboard</title>
    <link rel="stylesheet" href="dashstyles.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,1,0" />
    <link rel="icon" sizes="32x32" type="image/png" href="../assets/Images/favicon.png" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <nav id="Nav">
        <a  class="logolink" href="#">
            <img src="../assets/Images/Valitnotext2.png" class="logo">
            <h1  id="LogotextID" class="logo-text">Valit</h1>
        </a>
        <ul>
            <div>
                <li><a class="navLink" href="./overview.html"><span class="material-symbols-outlined">home</span>Overview</a></li>
                <li><a class="navLink" href="./payments.html"><span class="material-symbols-outlined">paid</span>Payments</a></li>
                <li><a class="navLink" href="./designer.html"><span class="material-symbols-outlined">receipt</span>Receipt design</a></li>
                <li><a class="navLink" href="./account.html"><span class="material-symbols-outlined">person</span>Account</a></li>
                <li><a class="navLink" href="./help.html"><span class="material-symbols-outlined">help</span>Help</a></li>
                
            </div>
            <div class="settingsMenu">
                <div class="CMholder">
                    <h4 id="CMtitle" >Dark/Light</h4>
                    <input type="checkbox" class="CMcheckbox" id="CMcheckbox">
                    <label id="CMcheckbox-label" for="CMcheckbox" class="CMcheckbox-label">
                        <span id="CM-IconD" class="material-symbols-outlined DM">dark_mode</span>
                        <span id="CM-IconL" class="material-symbols-outlined LM">light_mode</span>

                        <span id="CMslider" class="CMslider"></span>
                    </label>
                </div>
                
                <a id="nav-logout" class="logoutNav" href="../index.html">Log Out</a>
            </div>
        </ul>
       
    </nav>

    <div id="analysis">
        <div class="container">
            <div class="filter">
                <div>
                    
                    <div id="DDbox" class="dropDown">
                        <div class="select">
                            <span class="selected">Coffestore 21</span>
                            <div class="caret"></div>
                        </div>
                        <ul class="menu">
                            <li class="active">Coffestore 21</li>
                            <li>Coffestore 22</li>
                            <li>Coffestore 23</li>
                            <li>Coffestore 24</li>
                            <li>Coffestore 25</li>

                        </ul>
                        
                    </div>

            


                </div>
                
                <a id="addStoreBtn" class="addStoreBtn" onclick="addstore('Test')"><span class="material-symbols-outlined">add</span>Add store</a>
            </div>
            <div id="filter1ID" class="filterS1">
                <div>
                    <input type="radio" name="slider" id="todaytab" checked>
                    <input type="radio" name="slider" id="monthtab">
                    <input type="radio" name="slider" id="yeartab">
                    <header>
                        <label for="todaytab" class="todaytab">Today</label>
                        <label for="monthtab" class="monthtab">This month</label>
                        <label for="yeartab" class="yeartab">This year</label>
                        <div class="slider">
                            
                        </div>
                    </header>
                </div>
                <a id="SettingBtnID" class="settingsbtn" ><span class="material-symbols-outlined">settings</span></a>
            </div>



            <div class="sectionOne">


                <div class="S1">
                    <div class="S1wrapper">
                        <div class="S1slider">
                            <div id="collection-1" class="collection">
                                <span class="material-symbols-outlined">bar_chart</span>
                                <h2>Receipts today</h2>
                                <p class="receiptCounter">21 Receipts</p>
                            </div>
                            <div id="collection-2" class="collection">
                                <span class="material-symbols-outlined">monitoring</span>
                                <h2>Transactions today</h2>
                                <p class="receiptCounter">37 transactions</p>
                            </div>
                        </div>
                        <div class="S1slider-nav">
                            <a id="R1" href="#" class="sliderIndicator activeDataS1"></a>
                            <a id="R2" href="#" class="sliderIndicator"></a>
                        </div>
                    </div>
                    
                    
                </div>


                <div  class="S1">
                    <div class="S1wrapper">
                        <div class="S1slider">
                            <div id="collection-3" class="collection">
                                <span class="material-symbols-outlined">trending_up</span>
                                <h2>Saved today</h2>
                                <p class="payCounter">27 SEK</p>
                            </div>
                            <div id="collection-4" class="collection">
                                <span class="material-symbols-outlined">attach_money</span>
                                <h2>Spent today</h2>
                                <p class="payCounter">15 SEK</p>
                            </div>
                          
                            
                        </div>
                        <div class="S1slider-nav">
                            <a  id="F1" href="#" class="sliderIndicator activeDataS1"></a>
                            <a  id="F2" href="#" class="sliderIndicator"></a>
                        </div>
                    </div>

                </div>




                <div  class="S1">

                    <div class="S1wrapper">
                        <div class="S1slider">
                            <div id="collection-5" class="collection">
                                <span class="material-symbols-outlined">co2</span>
                                <h2>CO2 saved today</h2>
                                <p class="CO2Counter">0,4 kg</p>
                            </div>
                            <div id="collection-6" class="collection">
                                <span class="material-symbols-outlined">nature</span>
                                <h2>Trees saved today</h2>
                                <p class="CO2Counter">2 Trees</p>
                            </div>
                          
                            
                        </div>
                        <div class="S1slider-nav">
                            <a  id="C1" href="#" class="sliderIndicator activeDataS1"></a>
                            <a  id="C2" href="#" class="sliderIndicator"></a>
                        </div>
                    </div>

                    





                </div>
            </div>


            <div class="chartlist">
                <div class="box">
                    <canvas id="CO2chart" class="CO2chartS1" ></canvas>

                </div>
                <div class="box">
                    <canvas id="receiptUsagechart" class="PricingchartS1"></canvas>

                </div>
            </div>



        </div>
     
    </div>


</body>
    <script>

  
    var Opacity = 1;

    var labelsReceiptUsage = ['00:00','01:00','02:00', '03:00', '04:00', '05:00', '06:00', '07:00', '08:00', '09:00'];
    var receiptUsageData = [24,25,30,47,60,65,69,78,83,90];
    var backgroundcolors = [
                `rgba(255, 99, 132, ${Opacity})`,
                `rgba(255, 159, 64, ${Opacity})`,
                `rgba(255, 205, 86, ${Opacity})`,
                `rgba(75, 192, 192, ${Opacity})`,
                `rgba(54, 162, 235, ${Opacity})`,
                `rgba(153, 102, 255, ${Opacity})`,
                `rgba(201, 203, 207, ${Opacity})`,
                `rgba(201, 203, 207, ${Opacity})`,
                `rgba(201, 203, 207, ${Opacity})`,
                `rgba(201, 203, 207, ${Opacity})`
                ]

    var receiptUsageDataset = [{
                label: ['SEK saved with Valit'],
                data: receiptUsageData,
                backgroundColor: backgroundcolors,
                borderColor: [
                'rgb(255, 99, 132)',
                'rgb(255, 159, 64)',
                'rgb(255, 205, 86)',
                'rgb(75, 192, 192)',
                'rgb(54, 162, 235)',
                'rgb(153, 102, 255)',
                'rgb(255, 99, 132)',
                'rgb(255, 159, 64)',
                'rgb(255, 205, 86)',
                'rgb(75, 192, 192)',
                'rgb(54, 162, 235)',
                'rgb(153, 102, 255)',

                ],
                borderWidth: 1
            }]

    var gridColorsSavedChart = "rgba(255,255,255,0.1)"
    var receiptChartID = new Chart("receiptUsagechart", {
        type: 'bar',
        data: {
            labels: labelsReceiptUsage,
            datasets: receiptUsageDataset, 
        },
        options: {
            scales:{
                y:{
                    grid:{
                        color: gridColorsSavedChart,
                        
                    }
                },
                x: {
                    grid:{
                        color: gridColorsSavedChart,
                    }
                }
            },
            responsive: true,
            maintainAspectRatio: false
        }
    })


    var xValues = ["Kg CO2 saved today", "Kg CO2 left to daily goal"];
    var yValues = [50,55];

   
    var barColors = [
    "rgba(75, 192, 192, 1)", "rgba(0,0,0,0.1)"
    ];
  
    

    var chartCO2 = new Chart("CO2chart", {
    type: "doughnut",
    data: {
        labels: xValues,
        datasets: [{
        backgroundColor: barColors,
        data: yValues,
        borderColor: ["rgba(75, 192, 192, 0.5)", "rgba(255,255,255,0.05)"],
        }],
        
    },
    options: {
        title: {
        display: true,
        text: "Daily CO2 goal"
        },
        responsive: true,
        maintainAspectRatio: false
    }
    });

 

    



    function dropDownCM(mode) {
        const dropDownList = document.querySelectorAll(".dropDown");
        dropDownList.forEach(dropdown => {
            const select = dropdown.querySelector(".select");
            const caret = dropdown.querySelector(".caret");
            const menu = dropdown.querySelector(".menu");
            const options = dropdown.querySelectorAll(".menu li")
            const selected = dropdown.querySelector(".selected");

            if(mode == "LM") {
                selected.style.color = "#212121";
                selected.style.fontWeight = "700";
                caret.style.borderTop ="11px solid #212121";
                menu.classList.remove("menuDM");
                menu.classList.add("menuLM");



            } else {
                selected.style.color = "#fff";
                selected.style.fontWeight = "700";
                caret.style.borderTop ="11px solid #fff";
              
                menu.classList.remove("menuLM");
                menu.classList.add("menuDM");

            }
            

        })
    }


    if(localStorage.getItem("usrCred") == ""){
        window.location.href = "../auth/signin.html"
    } 




    const sliderNavList = document.querySelectorAll(".sliderIndicator")
    sliderNavList.forEach(nav => {
        nav.addEventListener("click", () => {
            if(nav.id.includes("R")) {

                sliderNavList.forEach(item => {
                    if(item.id.includes("R")){
                        item.classList.remove("activeDataS1")
                    }
                })
                nav.classList.add("activeDataS1")

                if(nav.id.includes("2")){
                    document.getElementById("collection-1").classList.add("focus2")
                    document.getElementById("collection-2").classList.add("focus2")

                } else {
                    document.getElementById("collection-1").classList.remove("focus2")
                    document.getElementById("collection-2").classList.remove("focus2")
                }

            } else if (nav.id.includes("F")){

                sliderNavList.forEach(item => {
                    if(item.id.includes("F")){
                        item.classList.remove("activeDataS1")
                    }
                })
                nav.classList.add("activeDataS1")
                if(nav.id.includes("2")){
                    document.getElementById("collection-3").classList.add("focus2")
                    document.getElementById("collection-4").classList.add("focus2")

                } else {
                    document.getElementById("collection-3").classList.remove("focus2")
                    document.getElementById("collection-4").classList.remove("focus2")
                }


            } else if (nav.id.includes("C")) {
                sliderNavList.forEach(item => {
                    if(item.id.includes("C")){
                        item.classList.remove("activeDataS1")
                    }
                })
                nav.classList.add("activeDataS1")

                if(nav.id.includes("2")){
                    document.getElementById("collection-5").classList.add("focus2")
                    document.getElementById("collection-6").classList.add("focus2")

                } else {
                    document.getElementById("collection-5").classList.remove("focus2")
                    document.getElementById("collection-6").classList.remove("focus2")
                }
            }
            
        })
    })


    const dropDownList = document.querySelectorAll(".dropDown");
    dropDownList.forEach(dropdown => {
        const select = dropdown.querySelector(".select");
        const caret = dropdown.querySelector(".caret");
        const menu = dropdown.querySelector(".menu");
        const options = dropdown.querySelectorAll(".menu li")
        const selected = dropdown.querySelector(".selected");

        select.addEventListener("click", () =>{
            select.classList.toggle("select-clicked");
            caret.classList.toggle("caret-rotate");
            menu.classList.toggle("menu-open");
        })
        
        window.addEventListener('click', function(e){   
            if (document.getElementById('DDbox').contains(e.target)){
                // Clicked in box
            } else{
                select.classList.remove("select-clicked");
                caret.classList.remove("caret-rotate");
                menu.classList.remove("menu-open");
            }
        });

        options.forEach(option => {
            option.addEventListener("click", () =>{
                selected.innerText = option.innerText;
                select.classList.remove("select-clicked");
                caret.classList.remove("caret-rotate");
                menu.classList.remove("menu-open");
                options.forEach(option => {
                    option.classList.remove("active");
            
                })
                option.classList.add("active");
                
            })
        })

    })


    function CMsystemPreference(){
        if(window.matchMedia("(prefers-color-scheme:dark)").matches)
        {
            document.getElementById("CMcheckbox").checked = false;
            changeColorMode('DM');
            localStorage.setItem('ColorMode', "DM")

        } else {
            document.getElementById("CMcheckbox").checked = true;
            changeColorMode('LM');
            localStorage.setItem('ColorMode', "LM")
        }
    }

    if(localStorage.getItem("ColorMode") == "DM"){
        document.getElementById("CMcheckbox").checked = false;
        changeColorMode('DM');

    } else if (localStorage.getItem("ColorMode") == "LM") {
        document.getElementById("CMcheckbox").checked = true;
        changeColorMode('LM');
    } else {
        CMsystemPreference();
    }

    var checkbox = document.getElementById("CMcheckbox");
    checkbox.addEventListener('change', () => {
        if(document.getElementById("CMcheckbox").checked == true){
            changeColorMode('LM');
            localStorage.setItem('ColorMode', "LM")
            
        } else {
            changeColorMode('DM');
            localStorage.setItem('ColorMode', "DM")
            
        }
    })


   

    function addstore(){
        var storeselect = document.getElementById("storeSelect");
        var newstore = document.createElement("option");
        newstore.text= "123";
        storeselect.add(newstore);
    }


   

    function updateChartsCM(ColorMode){
        if(ColorMode == "LM"){
            gridColorsSavedChart = "rgba(0,0,0,0.1)"
            Opacity = 0.2
            
        } else {
            gridColorsSavedChart = "rgba(255,255,255,0.1)"
            Opacity = 1
            
        }


        receiptChartID.options.scales.y.grid.color = gridColorsSavedChart
        receiptChartID.options.scales.x.grid.color = gridColorsSavedChart
        receiptChartID.data.datasets[0].backgroundColor = [
                `rgba(255, 99, 132, ${Opacity})`,
                `rgba(255, 159, 64, ${Opacity})`,
                `rgba(255, 205, 86, ${Opacity})`,
                `rgba(75, 192, 192, ${Opacity})`,
                `rgba(54, 162, 235, ${Opacity})`,
                `rgba(153, 102, 255, ${Opacity})`,
                `rgba(255, 99, 132, ${Opacity})`,
                `rgba(255, 159, 64, ${Opacity})`,
                `rgba(255, 205, 86, ${Opacity})`,
                `rgba(75, 192, 192, ${Opacity})`,
                `rgba(54, 162, 235, ${Opacity})`,
                `rgba(153, 102, 255, ${Opacity})`,
                ]

    
        receiptChartID.update()
    }
   



    function changeColorMode(mode){
        if (mode == "LM"){
            document.body.style.background = "#edebef"
            document.getElementById("SettingBtnID").style.color = "#000"
            document.getElementById("filter1ID").style.color = "#000"
            document.getElementById("Nav").style.background = "#FFF"
            document.getElementById("LogotextID").style.color = "#121212" 
            document.getElementById("CMtitle").style.color ="#000"
            document.getElementById("nav-logout").style.backgroundColor ="#e41f1f8f"

            updateChartsCM("LM")
            dropDownCM("LM")

            var sliderindicatorList = document.querySelectorAll(".sliderIndicator")
            sliderindicatorList.forEach(indicator => {
                indicator.classList.remove("IndicatorDM")
                indicator.classList.add("IndicatorLM")
            })

            var navlist = document.getElementsByClassName("navLink")
            for (item of navlist) {
                item.style.color = "#070708"
            }
            

            var listS1 = document.getElementsByClassName("S1")
            for (item of listS1) {
                item.style.background = "#FFF"
                item.style.boxShadow = "10px 10px 15px rgba(0,0,0,0.05)"
                item.style.color = "#070708"

            }

            var listS2 = document.getElementsByClassName("box")
            for (item of listS2) {
                item.style.background = "#FFF"
                item.style.boxShadow = "10px 10px 15px rgba(0,0,0,0.05)"
                item.style.color = "#070708"
            }

        


        } else if (mode == "DM") {
            document.body.style.background = "#121212"
            document.getElementById("SettingBtnID").style.color = "#fff"
        
            document.getElementById("filter1ID").style.color = "#fff"
            document.getElementById("Nav").style.background = "#212121"
            document.getElementById("LogotextID").style.color = "#ccc"
            document.getElementById("CMtitle").style.color ="#707070"
            document.getElementById("nav-logout").style.backgroundColor ="#e41f1f"

            updateChartsCM("DM")
            dropDownCM("DM")


            var sliderindicatorList = document.querySelectorAll(".sliderIndicator")
            sliderindicatorList.forEach(indicator => {
                indicator.classList.remove("IndicatorLM")
                indicator.classList.add("IndicatorDM")
            })


            var navlist = document.getElementsByClassName("navLink")
            for (item of navlist) {
                item.style.color = "#ccc"
            }
            

            var list = document.getElementsByClassName("S1")
            for (item of list) {
                item.style.background = "#212121"
                item.style.boxShadow = "10px 10px 15px rgba(255,255,255,0.02)"
                item.style.color = "#FFF"

            }


            var listS2 = document.getElementsByClassName("box")
            for (item of listS2) {
                item.style.background = "#212121"
                item.style.boxShadow = "10px 10px 15px rgba(255,255,255,0.02)"

            }

           
        }
    }

    </script>

</html>